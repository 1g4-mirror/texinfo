\documentclass{book}
\usepackage{makeidx}\makeindex
\usepackage{amsfonts}
\usepackage{amsmath}
\usepackage[gen]{eurosym}
\usepackage[T1]{fontenc}
\usepackage{textcomp}
\usepackage{graphicx}
\usepackage{needspace}
\usepackage{etoolbox}
\usepackage{fontsize}
\usepackage{geometry}
\usepackage{fancyhdr}
\usepackage{float}
% use hidelinks to remove boxes around links to be similar with Texinfo TeX
\usepackage[hidelinks]{hyperref}
\usepackage[utf8]{inputenc}

% redefine the \mainmatter command such that it does not clear page
% as if in double page
\makeatletter
\renewcommand\mainmatter{\clearpage\@mainmattertrue\pagenumbering{arabic}}
\makeatother

% command that does nothing used to help with substitutions in commands
\newcommand{\GNUTexinfoplaceholder}[1]{}

% called when setting single headers
% use \nouppercase to match with Texinfo TeX style
\newcommand{\GNUTexinfosetsingleheader}{\pagestyle{fancy}
\fancyhf{}
\lhead{\nouppercase{\leftmark}}
\rhead{\thepage}
}

% called when setting double headers
\newcommand{\GNUTexinfosetdoubleheader}[1]{\pagestyle{fancy}
\fancyhf{}
\fancyhead[LE,RO]{\thepage}
\fancyhead[RE]{#1}
\fancyhead[LO]{\nouppercase{\leftmark}}
}

% for part and chapter, which call \thispagestyle{plain}
\fancypagestyle{plain}{ %
 \fancyhf{}
 \fancyhead[LE,RO]{\thepage}
}

% match Texinfo TeX style
\renewcommand{\headrulewidth}{0pt}%

% avoid pagebreak and headings setting for a sectionning command
\newcommand{\GNUTexinfonopagebreakheading}[2]{\let\clearpage\relax \let\cleardoublepage\relax \let\thispagestyle\GNUTexinfoplaceholder #1{#2}}


\renewcommand{\includegraphics}[1]{\fbox{FIG #1}}

% set default for @setchapternewpage
\makeatletter
\patchcmd{\chapter}{\if@openright\cleardoublepage\else\clearpage\fi}{\GNUTexinfoplaceholder{setchapternewpage placeholder}\clearpage}{}{}
\makeatother
\GNUTexinfosetsingleheader{}%


\begin{document}
\label{anchor:node-before}%

In node before
\label{anchor:anch_003a-in-node-before}%

\label{anchor:after}%

in node after
\label{anchor:anch_003a-in-node-after}%

\chapter{chap}
\label{anchor:chap}%

in chap
\label{anchor:anch_003a-in-chap}%

See \hyperref[anchor:anch_003a-in-node-before]{[chap], page~\pageref*{anchor:anch_003a-in-node-before}}.
See \hyperref[anchor:anch_003a-in-node-top]{[top sectionning], page~\pageref*{anchor:anch_003a-in-node-top}}.
See \hyperref[anchor:anch_003a-in-node-after]{[chap], page~\pageref*{anchor:anch_003a-in-node-after}}.
See \hyperref[anchor:anch_003a-in-chap]{[chap], page~\pageref*{anchor:anch_003a-in-chap}}.

See \hyperref[anchor:anch_003a-in-node-before]{[anch: in node before], page~\pageref*{anchor:anch_003a-in-node-before}}.
See \hyperref[anchor:anch_003a-in-node-top]{[anch: in node top], page~\pageref*{anchor:anch_003a-in-node-top}}.
See \hyperref[anchor:anch_003a-in-node-after]{[anch: in node after], page~\pageref*{anchor:anch_003a-in-node-after}}.
See \hyperref[anchor:anch_003a-in-chap]{[anch: in chap], page~\pageref*{anchor:anch_003a-in-chap}}.
\end{document}
